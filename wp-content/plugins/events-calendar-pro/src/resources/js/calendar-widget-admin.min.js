function calendar_toggle(e){e.find(".calendar-widget-filters-title").hide(),e.find(".calendar-widget-filters-operand").hide();var t=e.find(".calendar-widget-added-filters");if(t.length){var r=t.val()?jQuery.parseJSON(t.val()):new Object,a=get_term_count(r);a>0&&(e.find(".calendar-widget-filters-title").show(),a>1&&e.find(".calendar-widget-filters-operand").show())}}function calendar_toggle_all(){jQuery(".calendar-widget-filters-container").each(function(e,t){calendar_toggle(jQuery(t))})}function get_term_count(e){var t=0;for(var r in e)t+=e[r].length;return t}jQuery(document).ready(function(e){var t=e("body"),r={};t.is(".wp-customizer")&&(r={dropdownCssClass:"customizer-select2"}),e("div.widgets-sortables").on("sortstop",function(){setTimeout(function(){e("#widgets-right select.calendar-widget-add-filter").select2(r),calendar_toggle_all()},600)}),e("#widgets-right select.calendar-widget-add-filter").select2(r),t.on("change","select.calendar-widget-add-filter",function(t){e(".calendar-widget-filters-container").show();var r=e(this),a=e(this.options[this.selectedIndex]),n=r.parents(".widget-content"),i=n.find(".calendar-widget-filter-list"),d=n.find(".calendar-widget-added-filters"),l=a.attr("value"),o=a.closest("optgroup"),s=o.attr("id"),c=o.attr("label");if(0!==parseInt(l)){var f=d.val()?e.parseJSON(d.val()):new Object;if(f[s]||(f[s]=new Array),-1==jQuery.inArray(l,f[s])){f[s].push(l),d.val(JSON.stringify(f));var g=e("<a/>").addClass("calendar-widget-remove-filter").attr("data-tax",s).attr("data-term",l).text("(remove)").attr("href","#"),p=e("<span/>").append(g),u=e("<li/>").append("p").text(c+": "+a.text()+"   ").append(p);i.append(u),calendar_toggle(n)}}}),t.on("click",".calendar-widget-remove-filter",function(t){t.preventDefault();var r=e(this),a=r.attr("data-tax"),n=r.attr("data-term"),i=r.parents(".widget-content"),d=i.find(".calendar-widget-added-filters"),l=d.val()?e.parseJSON(d.val()):new Object;l[a]&&l[a].myremove(n),d.val(JSON.stringify(l)),r.closest("li").remove(),r.closest(".customize-control-widget_form").find('input[name^="widget-tribe-mini-calendar"]').trigger("change"),calendar_toggle(i)}),Array.prototype.myremove=function(){for(var e,t,r=arguments,a=r.length;a&&this.length;)for(e=r[--a];-1!=(t=this.indexOf(e));)this.splice(t,1);return this},Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){t=t||0;for(var r=this.length;r>t;){if(this[t]===e)return t;++t}return-1})});