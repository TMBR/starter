function calendar_toggle(e){e.find(".calendar-widget-filters-title").hide(),e.find(".calendar-widget-filters-operand").hide();var t=e.find(".calendar-widget-added-filters");if(t.length){var a=t.val()?jQuery.parseJSON(t.val()):new Object,r=get_term_count(a);r>0&&(e.find(".calendar-widget-filters-title").show(),r>1&&e.find(".calendar-widget-filters-operand").show())}}function calendar_toggle_all(){jQuery(".calendar-widget-filters-container").each(function(e,t){calendar_toggle(jQuery(t))})}function get_term_count(e){var t=0;for(var a in e)t+=e[a].length;return t}jQuery(document).ready(function(e){var t=e("body"),a={};t.is(".wp-customizer")&&(a={dropdownCssClass:"customizer-select2"}),e("#widgets-right select.calendar-widget-add-filter").select2(a),t.on("change","select.calendar-widget-add-filter",function(t){e(".calendar-widget-filters-container").show();var a=e(this),r=e(this.options[this.selectedIndex]),n=a.parents(".widget-content"),i=n.find(".calendar-widget-filter-list"),d=n.find(".calendar-widget-added-filters"),l=r.attr("value"),c=r.closest("optgroup"),o=c.attr("id"),s=c.attr("label");if(0!==parseInt(l)){var f=d.val()?e.parseJSON(d.val()):new Object;if(f[o]||(f[o]=new Array),jQuery.inArray(l,f[o])==-1){f[o].push(l),d.val(JSON.stringify(f));var g=e("<a/>").addClass("calendar-widget-remove-filter").attr("data-tax",o).attr("data-term",l).text("(remove)").attr("href","#"),p=e("<span/>").append(g),u=e("<li/>").append("p").text(s+": "+r.text()+"   ").append(p);i.append(u),calendar_toggle(n)}}}),t.on("click",".calendar-widget-remove-filter",function(t){t.preventDefault();var a=e(this),r=a.attr("data-tax"),n=a.attr("data-term"),i=a.parents(".widget-content"),d=i.find(".calendar-widget-added-filters"),l=d.val()?e.parseJSON(d.val()):new Object;l[r]&&(l[r]=e.grep(l[r],function(e){return e!=n})),d.val(JSON.stringify(l)),a.closest("li").remove(),a.closest(".customize-control-widget_form").find('input[name^="widget-tribe-mini-calendar"]').trigger("change"),calendar_toggle(i)}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){t=t||0;for(var a=this.length;t<a;){if(this[t]===e)return t;++t}return-1})});