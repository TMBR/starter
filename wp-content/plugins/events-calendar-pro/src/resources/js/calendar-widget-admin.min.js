function calendar_toggle(a){a.find(".calendar-widget-filters-title").hide(),a.find(".calendar-widget-filters-operand").hide();var b=a.find(".calendar-widget-added-filters");if(b.length){var c=b.val()?jQuery.parseJSON(b.val()):new Object,d=get_term_count(c);d>0&&(a.find(".calendar-widget-filters-title").show(),d>1&&a.find(".calendar-widget-filters-operand").show())}}function calendar_toggle_all(){jQuery(".calendar-widget-filters-container").each(function(a,b){calendar_toggle(jQuery(b))})}function get_term_count(a){var b=0;for(var c in a)b+=a[c].length;return b}jQuery(document).ready(function(a){var b=a("body"),c={};b.is(".wp-customizer")&&(c={dropdownCssClass:"customizer-select2"}),a("div.widgets-sortables").on("sortstop",function(){setTimeout(function(){a("#widgets-right select.calendar-widget-add-filter").select2(c),calendar_toggle_all()},600)}),a("#widgets-right select.calendar-widget-add-filter").select2(c),b.on("change","select.calendar-widget-add-filter",function(b){a(".calendar-widget-filters-container").show();var c=a(this),d=a(this.options[this.selectedIndex]),e=c.parents(".widget-content"),f=e.find(".calendar-widget-filter-list"),g=e.find(".calendar-widget-added-filters"),h=d.attr("value"),i=d.closest("optgroup"),j=i.attr("id"),k=i.attr("label");if(0!==parseInt(h)){var l=g.val()?a.parseJSON(g.val()):new Object;if(l[j]||(l[j]=new Array),-1==jQuery.inArray(h,l[j])){l[j].push(h),g.val(JSON.stringify(l));var m=a("<a/>").addClass("calendar-widget-remove-filter").attr("data-tax",j).attr("data-term",h).text("(remove)").attr("href","#"),n=a("<span/>").append(m),o=a("<li/>").append("p").text(k+": "+d.text()+"   ").append(n);f.append(o),calendar_toggle(e)}}}),b.on("click",".calendar-widget-remove-filter",function(b){b.preventDefault();var c=a(this),d=c.attr("data-tax"),e=c.attr("data-term"),f=c.parents(".widget-content"),g=f.find(".calendar-widget-added-filters"),h=g.val()?a.parseJSON(g.val()):new Object;h[d]&&h[d].myremove(e),g.val(JSON.stringify(h)),c.closest("li").remove(),c.closest(".customize-control-widget_form").find('input[name^="widget-tribe-mini-calendar"]').trigger("change"),calendar_toggle(f)}),Array.prototype.myremove=function(){for(var a,b,c=arguments,d=c.length;d&&this.length;)for(a=c[--d];-1!=(b=this.indexOf(a));)this.splice(b,1);return this},Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){b=b||0;for(var c=this.length;c>b;){if(this[b]===a)return b;++b}return-1})});